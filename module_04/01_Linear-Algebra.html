

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Linear Algebra Introduction &#8212; Computational Mechanics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'module_04/01_Linear-Algebra';</script>
    <link rel="shortcut icon" href="../_static/spiderman-favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Gauss Elimination" href="02_Gauss_elimination.html" />
    <link rel="prev" title="Computational Mechanics 4 - Linear Algebra" href="README.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/comp-mech-logo.svg" class="logo__image only-light" alt="Computational Mechanics - Home"/>
    <script>document.write(`<img src="../_static/comp-mech-logo.svg" class="logo__image only-dark" alt="Computational Mechanics - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Computational Mechanics
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../syllabus.html">Syllabus - Computational Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/update-github.html">Working in your  Fork on GitHub.com</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../module_01/README.html">Computational Mechanics 01 - Getting Started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../module_01/01_Interacting_with_Python.html">01 - Interacting with Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_01/02_Working_with_Python.html">02 - Working with Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_01/03_Numerical_error.html">03 - Numerical Error</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_01/HW_01.html">Homework</a></li>



















<li class="toctree-l2"><a class="reference internal" href="../projects/01_Getting-started-project.html">Computational Mechanics Project #01 - Heat Transfer in Forensic Science</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../module_02/README.html">Computational Mechanics 02 - Analyze Data</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../module_02/01_Cheers_Stats_Beers.html">01 - Cheers!  Stats with Beers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_02/02_Seeing_Stats.html">02 - Seeing stats in a new light</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_02/03_Linear_Regression_with_Real_Data.html">03 - Linear regression with real data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_02/04_Stats_and_Montecarlo.html">04 - Statistics and Monte-Carlo Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_02/HW_02.html">Homework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/02_Analyze-data_project.html">Project #02 - NYSE random walk predictor</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../module_03/README.html">Computational Mechanics 03- Initial Value Problems</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../module_03/01_Catch_Motion.html">Catch things in motion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_03/02_Step_Future.html">Step to the future</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_03/03_Get_Oscillations.html">Get with the oscillations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_03/04_Getting_to_the_root.html">Roots of Nonlinear functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_03/HW_03.html">Homework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/03_IVP-project.html">Initial Value Problems - Project</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="README.html">Computational Mechanics 4 - Linear Algebra</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Linear Algebra Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_Gauss_elimination.html">Gauss Elimination</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_Linear-regression-algebra.html">Linear Regression Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="HW_04.html">Homework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/04_Linear_Algebra-project.html">CompMech04-Linear Algebra Project</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../module_05/README.html">Computational Mechanics 5 - Boundary Value Problems</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../module_05/01_Revisiting_derivatives.html">Revisiting Derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_05/02_Keep_it_steady.html">Keep it Steady</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_05/03_Good_Vibrations.html">Good Vibrations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../module_05/HW_05.html">Homework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/05-BVPs_project.html">Computational Mechanics Boundary Values - Project 05</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../how-to/README.html">Quick How-to documents</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../how-to/polyfit.html">Creating a quadratic fit on random data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../how-to/for-loops.html">How to use a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop? <em>in Python</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="../projects/extra-FEA_material.html">Extra Material: Direct stiffness method for Finite Element analysis (FEA)</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/cooperrc/computational-mechanics/master?urlpath=tree/module_04/01_Linear-Algebra.md" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://compmech.uconn.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/cooperrc/computational-mechanics&urlpath=tree/computational-mechanics/module_04/01_Linear-Algebra.md&branch=master" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/cooperrc/computational-mechanics" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cooperrc/computational-mechanics/issues/new?title=Issue%20on%20page%20%2Fmodule_04/01_Linear-Algebra.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/module_04/01_Linear-Algebra.ipynb" target="_blank"
   class="btn btn-sm btn-download-notebook-button dropdown-item"
   title="Download notebook file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li><a href="../_sources/module_04/01_Linear-Algebra.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Linear Algebra Introduction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-with-mixing-tanks">Example with Mixing Tanks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Exercise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vectors">Vectors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#whats-a-vector">What’s a vector?</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-you-think-of-a-vector-depends-on-what-youre-doing">How you think of a vector depends on what you’re doing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-and-subtracting-scaled-vectors">Adding and subtracting scaled vectors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#representation-of-a-problem-with-matrices-and-vectors">Representation of a problem with Matrices and Vectors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#another-linear-system-solution">1. Another linear system solution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Exercise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pause-and-ponder">Pause and ponder</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#singular-and-ill-conditioned-matrices">Singular and ill-conditioned matrices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-norms">Matrix norms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#condition-of-a-matrix">Condition of a matrix</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#just-checked-in-to-see-what-condition-my-condition-was-in"><em>just checked in to see what condition my condition was in</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Exercise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-youve-learned">What you’ve learned</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="linear-algebra-introduction">
<h1>Linear Algebra Introduction<a class="headerlink" href="#linear-algebra-introduction" title="Permalink to this heading">#</a></h1>
<p>Linear algebra is a representation of linear equations. You can separate the known constants from unknown variables to represent your system of equations. Take the following example, there are three unknowns and three equations</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(5x_{1}+3x_{2} =1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_{1}+2x_{2}+3x_{3} =2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_{1}+x_{2}+x_{3} =3\)</span></p></li>
</ol>
<p>If you can represent your equations in a matrix-vector format, then you can use standard linear algebra routines to solve for the unknown variables, <span class="math notranslate nohighlight">\(x_1,~x_2,~and~x_3.\)</span></p>
<p>Consider the matrix form of equations 1-3 above:</p>
<p><span class="math notranslate nohighlight">\(\left[ \begin{array}{ccc}
5 &amp; 3 &amp; 0 \\
1 &amp; 2 &amp; 3 \\
1 &amp; 1 &amp; 1 \end{array} \right]
\left[\begin{array}{c} 
x_{1} \\ 
x_{2} \\
x_{3}\end{array}\right]=\left[\begin{array}{c} 
1 \\
2 \\
3\end{array}\right]\)</span></p>
<p><span class="math notranslate nohighlight">\(\mathbf{Ax}=\mathbf{b}\)</span></p>
<p>The <strong>matrix</strong>, <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> contains all of the constants that are multiplied by your unknown variables <span class="math notranslate nohighlight">\(x_1,~x_2,~and~x_3.\)</span> The <strong>vector</strong>, <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> contains all of the known constants that are not multiplied by your unknown variables <span class="math notranslate nohighlight">\(x_1,~x_2,~and~x_3.\)</span> Finally, the <strong>vector</strong>, <span class="math notranslate nohighlight">\(\mathbf{x}=[x_1,~x_2,~x_3]\)</span> contains your unknown values.</p>
<section id="exercise">
<h2>Exercise<a class="headerlink" href="#exercise" title="Permalink to this heading">#</a></h2>
<p>Solve for <span class="math notranslate nohighlight">\(x_1,~x_2,~and~x_3.\)</span> How did you approach the problem? Did you use Linear algebra?</p>
<p>Highlight for answers: <font color="white">x1 = 20, x2 = -33, x3 = 16</font></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">19</span><span class="p">,</span><span class="mi">12</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">]])</span>
<span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">])</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;[</span><span class="si">{:5.1f}</span><span class="s1"> </span><span class="si">{:5.1f}</span><span class="s1"> </span><span class="si">{:5.1f}</span><span class="s1">] </span><span class="si">{}</span><span class="s1"> [</span><span class="si">{:3.1f}</span><span class="s1">] </span><span class="si">{}</span><span class="s1"> [</span><span class="si">{:5.1f}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ -7.0   3.0   0.0] * [3.9] = [-20.0]
[  7.0 -19.0  12.0] * [2.3] = [  0.0]
[  0.0   4.0 -12.0] * [1.4] = [ -8.0]
</pre></div>
</div>
</div>
</div>
<p>You use linear algebra <em>operations</em> to standardize the way you approach a set of equations. If you knew another matrix <span class="math notranslate nohighlight">\(\mathbf{A}^{-1}\)</span> that you could multiply both sides of your equation and get a new equation</p>
<p><span class="math notranslate nohighlight">\(\mathbf{A^{-1} A x}= \mathbf{A_n b}\)</span></p>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A^{-1} A x} = \mathbf{x}\)</span></p>
<p>then <span class="math notranslate nohighlight">\(\mathbf{x} = \mathbf{A^{-1} b}\)</span></p>
<p>if this youre a single equation with a single unknown, then you just use the inverse of A as such</p>
<p><span class="math notranslate nohighlight">\(12 x = 6\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{1}{12} 12 x = \frac{1}{12} 6\)</span></p>
<p><span class="math notranslate nohighlight">\(x=2\)</span></p>
<p>In this notebook, you will look at how to frame your problems as linear algebra problems and work on how to get <span class="math notranslate nohighlight">\(\mathbf{A}^{-1}\)</span> or <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> in the next two notebooks.</p>
</section>
<section id="example-with-mixing-tanks">
<h2>Example with Mixing Tanks<a class="headerlink" href="#example-with-mixing-tanks" title="Permalink to this heading">#</a></h2>
<p><img alt="Mixing tank volume flow rates" src="../_images/mixing_tanks.png" /></p>
<p>In the diagram above you have three tanks of water that are mixing two concentrations of salt water with <span class="math notranslate nohighlight">\(5~mg/m^3\)</span> entering tank 1 and <span class="math notranslate nohighlight">\(1~mg/m^3\)</span> entering tank three. The outlet is located on the middle tank 2, but the concentration is unknown.</p>
<p>The volume flow rates of water are shown on each arrow to denote flow in/out of each tank. You want to know what the final concentration at the outlet is <span class="math notranslate nohighlight">\(c_2\)</span>, but in order to know that you need the concentrations of <span class="math notranslate nohighlight">\(c_1~and~c_3\)</span>. The mass flow of the salt is the concentration <span class="math notranslate nohighlight">\(\times\)</span> volume flow rate. The total mass flow in - mass flow out in each container is 0. You have three mass balance equations</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\((-7~m^3/s)~c_1 +(3~m^3/s)~c_2 +(4~m^3/s)~5~mg/m^3 = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((7~m^3/s)~c_1 -(3~m^3/s)~c_2 -(4~m^3/s)~c_2 -(12~m^3/s)~c_2 +(12~m^3/s)~c_3 = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\((4~m^3/s)~c_2 -(12~m^3/s)~c_3 + (8~m^3/s)~1~mg/m^3 = 0\)</span></p></li>
</ol>
<p>or rearranging your mass-balance equations you have</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(-7c_1+3c_2=-20\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(7c_1-19c_2+12c_3=0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(4c_2-12c_3=-8\)</span></p></li>
</ol>
<p>You can put this into the same form that you used above with the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and vectors <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span></p>
<p><span class="math notranslate nohighlight">\(\left[ \begin{array}{ccc}
-7 &amp; 3 &amp; 0 \\
7 &amp; -19 &amp; 12 \\
0 &amp; 4 &amp; -12 \end{array} \right]
\left[\begin{array}{c} 
c_{1} \\ 
c_{2} \\
c_{3}\end{array}\right]=\left[\begin{array}{c} 
-20 \\
0 \\
-8\end{array}\right]\)</span></p>
<p><span class="math notranslate nohighlight">\(\mathbf{Ax}=\mathbf{b}\)</span></p>
<p>Now, let’s use some numpy linear algebra to solve for <span class="math notranslate nohighlight">\(c_2\)</span>. First, define <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> your known constants.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">19</span><span class="p">,</span><span class="mi">12</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">]])</span>
<span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;matrix A:</span><span class="se">\t</span><span class="s1"> vector b:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>matrix A:	 vector b:
[-7  3  0] 	 -5
[  7 -19  12] 	 0
[  0   4 -12] 	 -8
</pre></div>
</div>
</div>
</div>
<p>Now, you can solve for <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> with the function <code class="docutils literal notranslate"><span class="pre">np.linalg.solve</span></code>.
This is an advanced linear algebra solver that incorporates some ideas
we will explore in <a class="reference internal" href="02_Gauss_elimination.html"><span class="doc std std-doc">Module 02</span></a>. For now,
we just want to understand the inputs and outputs</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<p>In the next cell, you run this line of code. The inputs are the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>, as defined above as <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>. The output is your unknown vector <span class="math notranslate nohighlight">\(\mathbf{x}=[c_1,~c_2,~c_3]\)</span>. If you plug in the values of <code class="docutils literal notranslate"><span class="pre">x</span></code> into your mass balance equations you will see that mass is conserved.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;c1 = </span><span class="si">{:.2f}</span><span class="s1"> mg/m^3,</span><span class="se">\n</span><span class="s1">c2 = </span><span class="si">{:.2f}</span><span class="s1"> mg/m^3,</span><span class="se">\n</span><span class="s1">c3 = </span><span class="si">{:.2f}</span><span class="s1"> mg/mm^3&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c1 = 1.18 mg/m^3,
c2 = 1.08 mg/m^3,
c3 = 1.03 mg/mm^3
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h2>Exercise<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<p>Show that <span class="math notranslate nohighlight">\(\mathbf{Ax} = \mathbf{b}\)</span> in the previous mixing container example. Plug the values of <code class="docutils literal notranslate"><span class="pre">x</span></code> into the three equations and show that mass is conserved.</p>
</section>
<section id="vectors">
<h2>Vectors<a class="headerlink" href="#vectors" title="Permalink to this heading">#</a></h2>
<p>You use vectors to represent unknown variables or known outputs. In numpy, a vector only has one dimension.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p>If you ask for the <code class="docutils literal notranslate"><span class="pre">shape</span></code> of <code class="docutils literal notranslate"><span class="pre">y</span></code>, you get an output of <code class="docutils literal notranslate"><span class="pre">(3,)</span></code>, which means it is a one dimensional vector.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

<span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3,)
</pre></div>
</div>
</div>
</div>
<section id="whats-a-vector">
<h3>What’s a vector?<a class="headerlink" href="#whats-a-vector" title="Permalink to this heading">#</a></h3>
<p>Vectors are everywhere: physics, engineering, mathematics, computer science, video games, and more. Each field’s interpretation of what a vector <em>is</em> may be different, but  vectors live a similar life in every space.</p>
<p>The first episode in the wonderful video series, <a class="reference external" href="http://3b1b.co/eola"><em>“Essence of Linear Algebra”</em></a> tells you of three different ideas about vectors [1]:</p>
<ol class="arabic simple">
<li><p>For physicists, a vector is an “arrow” of a given length (magnitude) and direction. It can represent directional quantities like velocity, force, acceleration.</p></li>
<li><p>For computer scientists, a vector is an ordered list of numbers. It can represent a set of variables or features stored in order.</p></li>
<li><p>For mathematicians, vectors are generic objects that behave a certain way when they are added or scaled:  <span class="math notranslate nohighlight">\(\mathbf{u}+\mathbf{v}\)</span>, <span class="math notranslate nohighlight">\(\alpha\mathbf{v}\)</span>.</p></li>
</ol>
<p><img alt="Two interpretations of a vector: in physics its a magnitude anddirection and in computer science its an ordered list of numbers" src="../_images/whatsavector.png" /></p>
<section id="how-you-think-of-a-vector-depends-on-what-youre-doing">
<h4>How you think of a vector depends on what you’re doing<a class="headerlink" href="#how-you-think-of-a-vector-depends-on-what-youre-doing" title="Permalink to this heading">#</a></h4>
<p>In physics, vectors are almost always two- or three-dimensional
(although in some fancy branches of physics they do go to higher
dimensions). Vectors help physicists describe things like motion and
electro-magnetic fields on a plane or in physical 3D space.</p>
<p>But, as you saw in your first example of Linear algebra for a set of
equations, the vector could be a set of known or unknown values. This is
closer to how vectors are treated in computer science and data science,
vectors are often multi-dimensional, that is, they have many components.
They contain a set of ordered variables in a data model, like for
example: the age, youight, daily hours of sleep, youekly hours of
exercise, and blood pressure of an individual (five dimensions).</p>
</section>
</section>
</section>
<section id="adding-and-subtracting-scaled-vectors">
<h2>Adding and subtracting scaled vectors<a class="headerlink" href="#adding-and-subtracting-scaled-vectors" title="Permalink to this heading">#</a></h2>
<p>In your first linear algebra problem, you had the vector, <span class="math notranslate nohighlight">\(\mathbf{x}=[c_1,~c_2,~c_3]\)</span> and solved for <span class="math notranslate nohighlight">\(\mathbf{x}=[3.86,~2.33,~1.44]~mg/m^3\)</span>. You separated the flow rates out of the equation, but you could also have pulled out the flow rates in three vectors:</p>
<p><span class="math notranslate nohighlight">\(y=Ax=\left[\begin{array}{c} -20 \\ 0 \\-8\end{array}\right] =
\left[\begin{array}{c} -7 \\ 7 \\0\end{array}\right] c_{1}+
\left[\begin{array}{c} 3 \\ -19 \\ 4\end{array}\right] c_{2}+
\left[\begin{array}{c} 0 \\ 12 \\ -12\end{array}\right] c_{3}\)</span></p>
<p>or</p>
<p><span class="math notranslate nohighlight">\(\left[\begin{array}{c} -20 \\ 0 \\ -8\end{array}\right] =
\left[\begin{array}{c} -7 \\ 7 \\ 0\end{array}\right] 3.86+
\left[\begin{array}{c} 3 \\ -19 \\ 4\end{array}\right] 2.33+
\left[\begin{array}{c} 0 \\ 12 \\ -12\end{array}\right] 1.44 =
\left[\begin{array}{c} -20 \\ 0 \\ -8\end{array}\right]\)</span></p>
<p>When you multiply a vector by a scalar (something with a single magnitude, a number) the result is that each component of the vector is multiplied by that scalar. That’s why you can separate the flow rates and multiply them by the individual concentrations and add the results.</p>
<p><span class="math notranslate nohighlight">\(y = a_{1}x_{1} + a_{2}x_{2} +...+a_{N}x_{N}\)</span></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a_{i}\)</span> is a column vector</p></li>
<li><p><span class="math notranslate nohighlight">\(x_{i}\)</span> is a scalar taken from the <span class="math notranslate nohighlight">\(i^{th}\)</span> element of x.</p></li>
</ul>
<p>Multiplying a vector by a scalar is the same as multiplying each component of the vector by the scalar. So if you multiply a vector <span class="math notranslate nohighlight">\(\mathbf{a}\)</span> by 2, then it is the same as multiplying each component, <span class="math notranslate nohighlight">\(a_i\)</span> by 2.</p>
<p><span class="math notranslate nohighlight">\(2\mathbf{a}=\left[\begin{array}{c} 
2a_{1} \\ 
2a_{2} \\
\vdots \\
2a_{n}\end{array}\right]\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">a2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">19</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">a3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="o">-</span><span class="mi">12</span><span class="p">])</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">a1</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">a2</span><span class="o">+</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">a3</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;external inputs&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;flow in at 1: </span><span class="si">{:.1f}</span><span class="s1"> g/s</span><span class="se">\n</span><span class="s1">flow in at 2: </span><span class="si">{:.1f}</span><span class="s1"> g/s</span><span class="se">\n</span><span class="s1">flow in at 3: </span><span class="si">{:.1f}</span><span class="s1"> g/s&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">out</span><span class="o">*-</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>external inputs
flow in at 1: 5.0 g/s
flow in at 2: -0.0 g/s
flow in at 3: 8.0 g/s
</pre></div>
</div>
</div>
</div>
</section>
<section id="representation-of-a-problem-with-matrices-and-vectors">
<h2>Representation of a problem with Matrices and Vectors<a class="headerlink" href="#representation-of-a-problem-with-matrices-and-vectors" title="Permalink to this heading">#</a></h2>
<p>There are two main types of problems that are solved with linear algebra. Let’s use the following variables to describe your problems.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{y}:\)</span> a set of known outputs, <span class="math notranslate nohighlight">\(y_{1},~y_{2},~...y_{N}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{A}:\)</span> a set of known constants from equations, <span class="math notranslate nohighlight">\(A=\left[ \begin{array}{cccc}
A_{11} &amp; A_{12} &amp;...&amp; A_{1N} \\
A_{21} &amp; A_{22} &amp;...&amp; A_{2N} \\
\vdots &amp; \vdots &amp;\ddots&amp; \vdots \\
A_{M1} &amp; A_{M2} &amp;...&amp; A_{MN}\end{array} \right]\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{x}:\)</span>a set of unknown inputs, <span class="math notranslate nohighlight">\(x_{1},~x_{2},~...x_{N}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda:\)</span> an unknown constant</p></li>
</ul>
<p>Using the variables defined above you describe the two main types of linear algebra problems:</p>
<ol class="arabic simple">
<li><p>linear system solutions where <span class="math notranslate nohighlight">\(\mathbf{Ax} = \mathbf{b}\)</span></p></li>
<li><p>eigenvalue soslutions where <span class="math notranslate nohighlight">\(\mathbf{Ax} = \lambda \mathbf{x}\)</span></p></li>
</ol>
<p>You saw an example of the first type, in the mixing example. Eigenvalue
problems come up in a number of engineering and science applications.
You will cover the application of eigenvalues in the last module when
you look at boundary value problems. You will restrict your initial applications of linear algebra to linear systems.</p>
</section>
<section id="another-linear-system-solution">
<h2>1. Another linear system solution<a class="headerlink" href="#another-linear-system-solution" title="Permalink to this heading">#</a></h2>
<p><img alt="Example of Applying Newton's second law to obtain a linear system" src="../_images/mass-pulley.png" /></p>
<p>In the above diagram, there are 4 masses, connected by 4 cords. Our goal is to create a system of equations that are solveable with Linear Algebra. You start with Newton’s second law to determine 4 equations of motion</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(m_1 a_1 = T_1 + \mu m_1g\cos\theta - m_1g\sin\theta\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(m_2 a_2 = T_2 -T_1 + \mu m_2g\cos\theta - m_2g\sin\theta\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(m_3 a_3 = T_3 -T_2 + \mu m_3g\cos\theta - m_3g\sin\theta\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(m_4 a_4 = T_3 - m_4g\)</span></p></li>
</ol>
<p>This gives us four equations with 7 unknowns <span class="math notranslate nohighlight">\((a_1,~a_2,~a_3,~a_4,~T_1,~T_2,~and~T_3).\)</span> You also have 3 constraints that relate the motion of masses 1-4:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(a_1 = a_2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(a_2 = a_3\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(-a_3 = a_4\)</span></p></li>
</ol>
<p>So you can limit your description of acceleration to just <span class="math notranslate nohighlight">\(a\)</span>, because the system only has one overall degree of freedom (as long as the connecting cords remain taut). Now you have four equations and four unknowns <span class="math notranslate nohighlight">\((a,~T_1,~T_2,~and~T_3).\)</span></p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(-m_1 a - T_1 = \mu m_1g\cos\theta - m_1g\sin\theta\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(-m_2 a - T_2 +T_1 = \mu m_2g\cos\theta - m_2g\sin\theta\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(-m_3 a - T_3 +T_2 = \mu m_3g\cos\theta - m_3g\sin\theta\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(m_4 a - T_3  = - m_4g\)</span></p></li>
</ol>
<p>or in the matrix-vector form:</p>
<p>$\left[ \begin{array}{cccc}
-m_1 &amp; -1 &amp; 0 &amp; 0 \
-m_2 &amp; 1 &amp; -1 &amp; 0\
-m_3 &amp; 0 &amp; 1 &amp; -1\
m_4 &amp; 0 &amp; 0 &amp; -1\end{array} \right]
\left[\begin{array}{c}
a \
T_1 \
T_2 \
T_{3}\end{array}\right]=\left[\begin{array}{c}
\mu m_1g\cos\theta - m_1g\sin\theta\
\mu m_2g\cos\theta - m_2g\sin\theta\
\mu m_3g\cos\theta - m_3g\sin\theta\</p>
<ul class="simple">
<li><p>m_4g\end{array}\right]$</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(\mathbf{Ax}=\mathbf{b}\)</span></p>
<p>Let’s use the following constants to solve for acceleration and tensions:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mu = 0.2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(m_1 = m_2 = m_3 = 2~kg\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(m_4 = 1~kg\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\theta=\dfrac{\pi}{4}=45^o\)</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">m1</span><span class="o">=</span><span class="n">m2</span><span class="o">=</span><span class="n">m3</span><span class="o">=</span><span class="mi">2</span>
<span class="n">m4</span><span class="o">=</span><span class="mi">1</span>
<span class="n">g</span> <span class="o">=</span><span class="mf">9.81</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>

<span class="n">A2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="n">m1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="n">m2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="n">m3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="n">m4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">mu</span><span class="o">*</span><span class="n">m1</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="n">m1</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">),</span>\
               <span class="n">mu</span><span class="o">*</span><span class="n">m2</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="n">m2</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">),</span>\
               <span class="n">mu</span><span class="o">*</span><span class="n">m3</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="n">m3</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">),</span>\
               <span class="o">-</span><span class="n">m4</span><span class="o">*</span><span class="n">g</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A2 = </span><span class="se">\t\t</span><span class="s1"> y2=&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">A2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">y2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A2 = 		 y2=
[-2 -1  0  0] 	 -12.486091542192055
[-2  1 -1  0] 	 -12.486091542192055
[-2  0  1 -1] 	 -12.486091542192055
[ 1  0  0 -1] 	 -9.81
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A2</span><span class="p">,</span><span class="n">y2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a=</span><span class="si">{:.2f}</span><span class="s1"> m/s/s</span><span class="se">\n</span><span class="s1">T1=</span><span class="si">{:.1f}</span><span class="s1"> N</span><span class="se">\n</span><span class="s1">T2=</span><span class="si">{:.1f}</span><span class="s1"> N</span><span class="se">\n</span><span class="s1">T3=</span><span class="si">{:.1f}</span><span class="s1"> N&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">x2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a=3.95 m/s/s
T1=4.6 N
T2=9.2 N
T3=13.8 N
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h2>Exercise<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Plug in the values that you solved into the original 4 equations. Show that your values for accelerations and tensions satisfy your initial equations.</p></li>
<li><p>Create a new vector <code class="docutils literal notranslate"><span class="pre">y3</span></code> where the coefficient of friction is <span class="math notranslate nohighlight">\(\mu=0.5\)</span> what is the new acceleration? Do the tensions increase or decrease when tension increases?</p></li>
</ol>
</section>
<section id="pause-and-ponder">
<h2>Pause and ponder<a class="headerlink" href="#pause-and-ponder" title="Permalink to this heading">#</a></h2>
<p>In this example, the unknown vector, <span class="math notranslate nohighlight">\(\mathbf{x}=[a,~T_1,~T_2,~T_3],\)</span> is a combination of acceleration and forces. This definition of a vector is less intuitive than a physics-based magnitude and direction, but it is <strong>extremely</strong> useful in solving engineering and physics problems. Here are a few <strong>key ideas</strong> from these two linear system exercises:</p>
<ul class="simple">
<li><p>In order to solve for <span class="math notranslate nohighlight">\(n\)</span> unknowns, you need <span class="math notranslate nohighlight">\(n\)</span> independent equations</p></li>
<li><p>A vector is a collection of numbers that you either know or want to know</p></li>
<li><p>A matrix is a collection of known numbers <em>note: there are some cases where you might want to solve for a matrix, but for now let’s restrict your use of linear algebra to known matrices</em></p></li>
</ul>
<p>The specification of <em>independent equations</em> is best illustrated using <em>dependent</em> equations:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(x+y = 3\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(2x+2y=6\)</span></p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A_sing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_sing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_sing</span><span class="p">,</span><span class="n">y_sing</span><span class="p">)</span>

<span class="go">---------------------------------------------------------------------------</span>
<span class="go">LinAlgError                               Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-9-b58617395425&gt; in &lt;module&gt;</span>
<span class="go">      1 A_sing = np.array([[1,1],[2,2]])</span>
<span class="go">      2 y_sing = np.array([3,6])</span>
<span class="go">----&gt; 3 np.linalg.solve(A_sing,y_sing)</span>

<span class="go">&lt;__array_function__ internals&gt; in solve(*args, **kwargs)</span>

<span class="go">~/.conda/envs/work/lib/python3.9/site-packages/numpy/linalg/linalg.py in solve(a, b)</span>
<span class="go">    392     signature = &#39;DD-&gt;D&#39; if isComplexType(t) else &#39;dd-&gt;d&#39;</span>
<span class="go">    393     extobj = get_linalg_error_extobj(_raise_linalgerror_singular)</span>
<span class="go">--&gt; 394     r = gufunc(a, b, signature=signature, extobj=extobj)</span>
<span class="go">    395 </span>
<span class="go">    396     return wrap(r.astype(result_t, copy=False))</span>

<span class="go">~/.conda/envs/work/lib/python3.9/site-packages/numpy/linalg/linalg.py in _raise_linalgerror_singular(err, flag)</span>
<span class="go">     86 </span>
<span class="go">     87 def _raise_linalgerror_singular(err, flag):</span>
<span class="go">---&gt; 88     raise LinAlgError(&quot;Singular matrix&quot;)</span>
<span class="go">     89 </span>
<span class="go">     90 def _raise_linalgerror_nonposdef(err, flag):</span>

<span class="go">LinAlgError: Singular matrix</span>
</pre></div>
</div>
</section>
<section id="singular-and-ill-conditioned-matrices">
<h2>Singular and ill-conditioned matrices<a class="headerlink" href="#singular-and-ill-conditioned-matrices" title="Permalink to this heading">#</a></h2>
<p>You receive the <code class="docutils literal notranslate"><span class="pre">LinAlgError:</span> <span class="pre">Singular</span> <span class="pre">matrix</span></code> because equation (2) is 2 <span class="math notranslate nohighlight">\(\times\)</span> (equation 1). A <strong>singular matrix</strong> represents a system of equations where multiple solutions exist.</p>
<p>For example, if x=1 and y=2, then</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(1+2 = 3\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(2+4 = 6\)</span></p></li>
</ol>
<p>But, you could also say that x=10 and y=-7</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(10-7 = 3\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(20-14 = 6\)</span></p></li>
</ol>
<p>Because the system of equations is <strong>singular</strong>, there are an infinite number of values for <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. In engineering, this usually means that you have used the same equation more than once to describe your system of equations, or that you have not properly constrained the problem.</p>
<p>You can also run into matrices that are almost singular, the equations are independent, but they are very close to being dependent. Take the singular example, but let’s add a small number, <span class="math notranslate nohighlight">\(\delta\)</span> to one of the constants.</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\delta x+y = 3\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(2x+(2+\delta)y=6\)</span></p></li>
</ol>
<p>Now, the equations are independent so you should be able to solve for <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>, but depending on the size of <span class="math notranslate nohighlight">\(\delta\)</span> and your machine epsilon (<code class="docutils literal notranslate"><span class="pre">np.floatinf('float').eps</span></code>) you may still have a singular matrix</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">2e-16</span><span class="p">,</span><span class="mf">5e-16</span><span class="p">,</span><span class="mf">10e-16</span><span class="p">]:</span>
    <span class="n">A_ill</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="o">+</span><span class="n">d</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
    <span class="n">y_ill</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="o">+</span><span class="n">d</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;d=&#39;</span><span class="p">,</span><span class="n">d</span><span class="p">)</span>
    <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_ill</span><span class="p">,</span><span class="n">y_ill</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x = </span><span class="si">{:.1f}</span><span class="s1">, y = </span><span class="si">{:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>d= 2e-16
x = -1.0, y = 4.0
d= 5e-16
x = -1.0, y = 4.0
d= 1e-15
x = -0.6, y = 3.6
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_ill</span><span class="p">)))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">A_ill</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.877244e+15
1.000000e+00
</pre></div>
</div>
</div>
</div>
<p>This problem is now <strong>ill-conditioned</strong>. For small changes (as small as the roundoff error in your floating point calculations) you can get different values of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y.\)</span> An <strong>ill-conditioned</strong> matrix (system of equations) is <em>almost</em> worse than the singular matrix because you still get a result, but you wouldn’t know the result is so sensitive to your representation of floating point numbers unless you checked the sensitivity of your results.</p>
<p>Luckily, <strong>ill-conditioned</strong> matrices come up often enough that there is a standard way to recognize the <strong>condition</strong> of a matrix. The <strong>condition</strong> of a matrix is the ratio of the measure of its “magnitude” compared to the “magnitude” of its inverse. Here “<em>magnitude</em>” is in quotes, because a matrix does not have a single magnitude and direction, instead you call the measure of a matrix a <strong>norm</strong>.</p>
</section>
<section id="matrix-norms">
<h2>Matrix norms<a class="headerlink" href="#matrix-norms" title="Permalink to this heading">#</a></h2>
<p>The Euclidean norm of a vector is measure of the magnitude (in 3D this would be: <span class="math notranslate nohighlight">\(|x|=\sqrt{x_{1}^{2}+x_{2}^{2}+x_{3}^{2}}\)</span>) in general the equation is:</p>
<p><span class="math notranslate nohighlight">\(||x||_{e}=\sqrt{\sum_{i=1}^{n}x_{i}^{2}}\)</span></p>
<p>For a matrix, A, the same norm is called the Frobenius norm:</p>
<p><span class="math notranslate nohighlight">\(||A||_{f}=\sqrt{\sum_{i=1}^{n}\sum_{j=1}^{m}A_{i,j}^{2}}\)</span></p>
<p>In general you can calculate any <span class="math notranslate nohighlight">\(p\)</span>-norm where</p>
<p><span class="math notranslate nohighlight">\(||A||_{p}=\sqrt{\sum_{i=1}^{n}\sum_{i=1}^{m}A_{i,j}^{p}}\)</span></p>
<p>so the p=1, 1-norm is</p>
<p><span class="math notranslate nohighlight">\(||A||_{1}=\sqrt{\sum_{i=1}^{n}\sum_{i=1}^{m}A_{i,j}^{1}}=\sum_{i=1}^{n}\sum_{i=1}^{m}|A_{i,j}|\)</span></p>
<p><span class="math notranslate nohighlight">\(||A||_{\infty}=\sqrt{\sum_{i=1}^{n}\sum_{i=1}^{m}A_{i,j}^{\infty}}=\max_{1\le i \le n}\sum_{j=1}^{m}|A_{i,j}|\)</span></p>
</section>
<section id="condition-of-a-matrix">
<h2>Condition of a matrix<a class="headerlink" href="#condition-of-a-matrix" title="Permalink to this heading">#</a></h2>
<section id="just-checked-in-to-see-what-condition-my-condition-was-in">
<h3><em>just checked in to see what condition my condition was in</em><a class="headerlink" href="#just-checked-in-to-see-what-condition-my-condition-was-in" title="Permalink to this heading">#</a></h3>
<p>The matrix condition is the product of</p>
<p><span class="math notranslate nohighlight">\(Cond(A) = ||A||\cdot||A^{-1}||\)</span></p>
<p>So each norm will have a different condition number, but the limit is <span class="math notranslate nohighlight">\(Cond(A)\ge 1\)</span></p>
<p>An estimate of the rounding error is based on the condition of A:</p>
<p><span class="math notranslate nohighlight">\(\frac{||\Delta x||}{x} \le Cond(A) \frac{||\Delta A||}{||A||}\)</span></p>
<p>So if the coefficients of A have accuracy to <span class="math notranslate nohighlight">\(10^{-t}\)</span></p>
<p>and the condition of A, <span class="math notranslate nohighlight">\(Cond(A)=10^{c}\)</span></p>
<p>then the solution for x can have rounding errors up to <span class="math notranslate nohighlight">\(10^{c-t}\)</span></p>
<p>The default norm using <code class="docutils literal notranslate"><span class="pre">np.linalg.norm</span></code> is the Frobenius norm, so let’s look at the error that can affect your output, <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>Here, you can say that the accuracy in your constants is <span class="math notranslate nohighlight">\(10^{-15}\)</span> so <span class="math notranslate nohighlight">\(t=15\)</span> and your norm for <span class="math notranslate nohighlight">\(\delta=10^{-15}\)</span> is</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="ow">in</span><span class="p">]:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_ill</span><span class="p">)))</span>
<span class="p">[</span><span class="n">out</span><span class="p">]:</span>
    <span class="mf">3.045e+15</span>
</pre></div>
</div>
<p>so <span class="math notranslate nohighlight">\(c = 15\)</span>. The expected error in <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> is then</p>
<p><span class="math notranslate nohighlight">\(10^{15-15} = 1\)</span></p>
<p>and if you look at the values you calculated when you changed <span class="math notranslate nohighlight">\(\delta\)</span>, the values youre within a range of <span class="math notranslate nohighlight">\(\approx 1\)</span>.</p>
<p>The <strong>key idea</strong> here is that the condition of the matrix is directly related to the accuracy of your solutions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">A_ill</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.877244e+15
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h3>Exercise<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<p>One of the most youll-known ill-conditioned matrices is the <a class="reference external" href="https://en.wikipedia.org/wiki/Hilbert_matrix">Hilbert Matrix</a>. It is created by placing smaller and smaller fractions in each successive row and column of a matrix.</p>
<p><span class="math notranslate nohighlight">\(H_{ij} = \frac{1}{i+j-1}\)</span></p>
<p><span class="math notranslate nohighlight">\(H = \left[\begin{array}{cccc} 
 1 &amp; \frac{1}{2} &amp; \frac{1}{3} &amp; \frac{1}{4} &amp; \frac{1}{5} \\
 \frac{1}{2} &amp; \frac{1}{3} &amp; \frac{1}{4} &amp; \frac{1}{5} &amp; \frac{1}{6} \\
 \frac{1}{3} &amp; \frac{1}{4} &amp; \frac{1}{5} &amp; \frac{1}{6} &amp; \frac{1}{7} \\
 \frac{1}{4} &amp; \frac{1}{5} &amp; \frac{1}{6} &amp; \frac{1}{7} &amp; \frac{1}{8} \\
 \frac{1}{5} &amp; \frac{1}{6} &amp; \frac{1}{7} &amp; \frac{1}{8} &amp; \frac{1}{9}
\end{array}\right]\)</span></p>
<p>What is the condition of this <span class="math notranslate nohighlight">\(4 \times 4\)</span> matrix?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">12</span>
<span class="n">H</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
        <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:,</span><span class="o">-</span><span class="mi">3</span><span class="p">:])</span>
<span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">lu</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0.05263158 0.05       0.04761905]
 [0.05       0.04761905 0.04545455]
 [0.04761905 0.04545455 0.04347826]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">u</span><span class="o">=</span><span class="n">lu</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:,</span><span class="o">-</span><span class="mi">3</span><span class="p">:])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:,</span><span class="o">-</span><span class="mi">3</span><span class="p">:])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.          0.          0.        ]
 [ 0.54930661  1.          0.        ]
 [-0.5629512  -0.45861917  1.        ]]
[[-1.00442848e-11 -5.12043047e-11 -1.50118321e-10]
 [ 0.00000000e+00  3.30756256e-13  1.83182636e-12]
 [ 0.00000000e+00  0.00000000e+00 -4.78089790e-15]]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="what-youve-learned">
<h2>What you’ve learned<a class="headerlink" href="#what-youve-learned" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>How to solve a linear algebra problem with <code class="docutils literal notranslate"><span class="pre">np.linalg.solve</span></code></p></li>
<li><p>Creating a linear system of equations</p></li>
<li><p>Identify constants in a linear system <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{b}\)</span></p></li>
<li><p>Identify unknown variables in a linear system <span class="math notranslate nohighlight">\(\mathbf{x}\)</span></p></li>
<li><p>Identify a <strong>singular</strong> or <strong>ill-conditioned</strong> matrix</p></li>
<li><p>Calculate the <strong>condition</strong> of a matrix</p></li>
<li><p>Estimate the error in the solution based upon the condition of a matrix</p></li>
</ul>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Chapra, Steven <em>Applied Numerical Methods with Matlab for Engineers.</em> <strong>ch 8.</strong> McGraw Hill.</p></li>
<li><p>Kiusalaas, Jaan <em>Numerical Methods in Engineering with Python 3.</em> <strong>ch 2.</strong> Cambridge University Press.</p></li>
<li><p><a class="reference external" href="http://3b1b.co/eola"><em>“Essence of Linear Algebra”</em></a> 3 Blue 1 Brown Linear algebra series.</p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./module_04"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="README.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Computational Mechanics 4 - Linear Algebra</p>
      </div>
    </a>
    <a class="right-next"
       href="02_Gauss_elimination.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Gauss Elimination</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise">Exercise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-with-mixing-tanks">Example with Mixing Tanks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Exercise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#vectors">Vectors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#whats-a-vector">What’s a vector?</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-you-think-of-a-vector-depends-on-what-youre-doing">How you think of a vector depends on what you’re doing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-and-subtracting-scaled-vectors">Adding and subtracting scaled vectors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#representation-of-a-problem-with-matrices-and-vectors">Representation of a problem with Matrices and Vectors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#another-linear-system-solution">1. Another linear system solution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Exercise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pause-and-ponder">Pause and ponder</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#singular-and-ill-conditioned-matrices">Singular and ill-conditioned matrices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-norms">Matrix norms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#condition-of-a-matrix">Condition of a matrix</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#just-checked-in-to-see-what-condition-my-condition-was-in"><em>just checked in to see what condition my condition was in</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Exercise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-youve-learned">What you’ve learned</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By <a href = https://cooperrc.github.io> Ryan C. Cooper</a>
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>